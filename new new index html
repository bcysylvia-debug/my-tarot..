<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡”ç½—å åœå·¥åŠ</title>
    <style>
        :root {
            --primary-color: #e0c097;
            --bg-gradient: radial-gradient(circle at center, #1a002a 0%, #050008 100%);
            --card-back: repeating-linear-gradient(45deg, #4a2c5a, #4a2c5a 5px, #2a0c3a 5px, #2a0c3a 10px);
        }

        body {
            background: var(--bg-gradient);
            color: var(--primary-color);
            font-family: 'STKaiti', 'Georgia', serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
        }

        h1 { text-shadow: 0 0 10px rgba(224, 192, 151, 0.5); margin: 15px 0 5px 0; }

        /* é¡¶éƒ¨ä¸»èœå• */
        .main-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            background: rgba(90, 56, 117, 0.3);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-btn.active {
            background: var(--primary-color);
            color: #1a002a;
        }

        /* æŠ½å–æ§åˆ¶åŒº */
        .controls { text-align: center; margin-bottom: 20px; }
        .action-btn {
            background: linear-gradient(45deg, #5a3875, #8a58a8);
            border: none;
            color: white;
            padding: 10px 30px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        /* ç‰ŒèƒŒå±•ç¤ºåŒº */
        #manual-deck {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 4px;
            max-width: 600px;
            margin-bottom: 20px;
        }

        .card-back {
            width: 30px;
            height: 50px;
            background: var(--card-back);
            border: 1px solid #5a3875;
            border-radius: 3px;
            cursor: pointer;
        }
        .card-back.selected { visibility: hidden; }

        /* ç»“æœå±•ç¤ºåŒº */
        .result-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            width: 100%;
            max-width: 800px;
        }

        .card-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.6s ease forwards;
            opacity: 0;
        }

        .label { font-size: 14px; margin-bottom: 5px; color: #b893cc; }

        /* å›¾ç‰‡å¤§å°æ§åˆ¶ */
        .img-wrap {
            width: 120px; /* è¾ƒå°çš„å›¾ç‰‡å°ºå¯¸ */
            height: 208px;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            overflow: hidden;
            background: #000;
            position: relative;
        }

        .img-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .reversed img { transform: rotate(180deg); }

        .card-name { margin-top: 8px; font-size: 14px; font-weight: bold; }
        .ans-tag { 
            margin-top: 5px; 
            padding: 2px 10px; 
            border-radius: 10px; 
            font-size: 18px;
            font-weight: 900;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #status-bar { margin-bottom: 10px; color: #b893cc; height: 20px; }
    </style>
</head>
<body>

    <h1>ğŸ”® å¡”ç½—åœ¨çº¿å åœ</h1>
    
    <div class="main-nav">
        <button class="nav-btn active" onclick="switchTab('triangle')">åœ£ä¸‰è§’(è¿‡å»ç°åœ¨æœªæ¥)</button>
        <button class="nav-btn" onclick="switchTab('free')">æ— ç‰Œé˜µ(ä¸‰å¼ å¹¶åˆ—)</button>
        <button class="nav-btn" onclick="switchTab('yesno')">Yes / No (å•å¼ )</button>
    </div>

    <div class="controls">
        <div id="status-bar">å‡†å¤‡å°±ç»ª</div>
        <div style="margin-bottom: 10px;">
            <button onclick="toggleDrawMode('random')" id="btn-rnd" class="nav-btn active">éšæœºæŠ½å–</button>
            <button onclick="toggleDrawMode('manual')" id="btn-man" class="nav-btn">äº²è‡ªé€‰ç‰Œ</button>
        </div>
        <button id="draw-trigger" class="action-btn" onclick="executeDraw()">å¼€å§‹å åœ</button>
    </div>

    <div id="manual-deck" style="display: none;"></div>

    <div class="result-container" id="results"></div>

<script>
    // åŸºç¡€æ•°æ®ä¸ä¹‹å‰çš„ç»´åŸºç™¾ç§‘é“¾æ¥ä¿æŒä¸€è‡´
    const baseUrl = "https://upload.wikimedia.org/wikipedia/commons/";
    const tarotData = [
        {name: "0-æ„šè€…", path: "9/90/RWS_Tarot_00_Fool.jpg", yn: "Yes"},
        {name: "I-é­”æœ¯å¸ˆ", path: "d/de/RWS_Tarot_01_Magician.jpg", yn: "Yes"},
        {name: "II-å¥³æ•™çš‡", path: "8/88/RWS_Tarot_02_High_Priestess.jpg", yn: "Maybe"},
        {name: "III-çš‡å", path: "d/d2/RWS_Tarot_03_Empress.jpg", yn: "Yes"},
        {name: "IV-çš‡å¸", path: "c/c3/RWS_Tarot_04_Emperor.jpg", yn: "Yes"},
        {name: "V-æ•™çš‡", path: "8/8d/RWS_Tarot_05_Hierophant.jpg", yn: "Yes"},
        {name: "VI-æ‹äºº", path: "3/3a/TheLovers.jpg", yn: "Yes"},
        {name: "VII-æˆ˜è½¦", path: "9/9b/RWS_Tarot_07_Chariot.jpg", yn: "Yes"},
        {name: "VIII-åŠ›é‡", path: "f/f5/RWS_Tarot_08_Strength.jpg", yn: "Yes"},
        {name: "IX-éšå£«", path: "4/4d/RWS_Tarot_09_Hermit.jpg", yn: "Maybe"},
        {name: "X-å‘½è¿ä¹‹è½®", path: "3/3c/RWS_Tarot_10_Wheel_of_Fortune.jpg", yn: "Yes"},
        {name: "XI-æ­£ä¹‰", path: "e/e0/RWS_Tarot_11_Justice.jpg", yn: "Maybe"},
        {name: "XII-å€’åŠäºº", path: "2/2b/RWS_Tarot_12_Hanged_Man.jpg", yn: "No"},
        {name: "XIII-æ­»ç¥", path: "d/d7/RWS_Tarot_13_Death.jpg", yn: "No"},
        {name: "XIV-èŠ‚åˆ¶", path: "f/f8/RWS_Tarot_14_Temperance.jpg", yn: "Yes"},
        {name: "XV-æ¶é­”", path: "5/55/RWS_Tarot_15_Devil.jpg", yn: "No"},
        {name: "XVI-é«˜å¡”", path: "5/53/RWS_Tarot_16_Tower.jpg", yn: "No"},
        {name: "XVII-æ˜Ÿæ˜Ÿ", path: "d/db/RWS_Tarot_17_Star.jpg", yn: "Yes"},
        {name: "XVIII-æœˆäº®", path: "7/7f/RWS_Tarot_18_Moon.jpg", yn: "No"},
        {name: "XIX-å¤ªé˜³", path: "1/17/RWS_Tarot_19_Sun.jpg", yn: "Yes"},
        {name: "XX-å®¡åˆ¤", path: "d/dd/RWS_Tarot_20_Judgement.jpg", yn: "Yes"},
        {name: "XXI-ä¸–ç•Œ", path: "f/ff/RWS_Tarot_21_World.jpg", yn: "Yes"},
        // å°é˜¿å¡çº³éƒ¨åˆ†æ˜ å°„ (ä¸ºèŠ‚çœç¯‡å¹…ï¼Œæ²¿ç”¨é€»è¾‘ï¼Œè¡¥å……äº†éƒ¨åˆ†YesNoå±æ€§)
        {name: "æƒæ–ä¸€", path: "1/11/Wands01.jpg", yn: "Yes"}, {name: "æƒæ–äºŒ", path: "0/0f/Wands02.jpg", yn: "Maybe"},
        {name: "æƒæ–ä¸‰", path: "f/ff/Wands03.jpg", yn: "Yes"}, {name: "æƒæ–å››", path: "a/a4/Wands04.jpg", yn: "Yes"},
        {name: "æƒæ–äº”", path: "9/9d/Wands05.jpg", yn: "No"}, {name: "æƒæ–å…­", path: "3/3b/Wands06.jpg", yn: "Yes"},
        {name: "æƒæ–ä¸ƒ", path: "e/e4/Wands07.jpg", yn: "Yes"}, {name: "æƒæ–å…«", path: "6/6b/Wands08.jpg", yn: "Yes"},
        {name: "æƒæ–ä¹", path: "4/4d/Tarot_Nine_of_Wands.jpg", yn: "Maybe"}, {name: "æƒæ–å", path: "0/0b/Wands10.jpg", yn: "No"},
        {name: "æƒæ–ä¾ä»", path: "6/6a/WandsPage.jpg", yn: "Yes"}, {name: "æƒæ–éª‘å£«", path: "1/16/WandsKnight.jpg", yn: "Yes"},
        {name: "æƒæ–ç‹å", path: "0/0d/WandsQueen.jpg", yn: "Yes"}, {name: "æƒæ–å›½ç‹", path: "c/ce/WandsKing.jpg", yn: "Yes"},
        {name: "åœ£æ¯ä¸€", path: "3/36/Cups01.jpg", yn: "Yes"}, {name: "åœ£æ¯äºŒ", path: "f/f8/Cups02.jpg", yn: "Yes"},
        {name: "åœ£æ¯ä¸‰", path: "7/7a/Cups03.jpg", yn: "Yes"}, {name: "åœ£æ¯å››", path: "3/35/Cups04.jpg", yn: "No"},
        {name: "åœ£æ¯äº”", path: "d/d7/Cups05.jpg", yn: "No"}, {name: "åœ£æ¯å…­", path: "1/17/Cups06.jpg", yn: "Yes"},
        {name: "åœ£æ¯ä¸ƒ", path: "a/ae/Cups07.jpg", yn: "Maybe"}, {name: "åœ£æ¯å…«", path: "6/60/Cups08.jpg", yn: "No"},
        {name: "åœ£æ¯ä¹", path: "2/24/Cups09.jpg", yn: "Yes"}, {name: "åœ£æ¯å", path: "8/84/Cups10.jpg", yn: "Yes"},
        {name: "åœ£æ¯ä¾ä»", path: "a/a6/CupsPage.jpg", yn: "Yes"}, {name: "åœ£æ¯éª‘å£«", path: "f/fa/CupsKnight.jpg", yn: "Yes"},
        {name: "åœ£æ¯ç‹å", path: "6/61/CupsQueen.jpg", yn: "Yes"}, {name: "åœ£æ¯å›½ç‹", path: "f/f0/CupsKing.jpg", yn: "Yes"},
        {name: "å®å‰‘ä¸€", path: "1/1a/Swords01.jpg", yn: "Yes"}, {name: "å®å‰‘äºŒ", path: "9/92/Swords02.jpg", yn: "Maybe"},
        {name: "å®å‰‘ä¸‰", path: "2/2c/Swords03.jpg", yn: "No"}, {name: "å®å‰‘å››", path: "b/bf/Swords04.jpg", yn: "Maybe"},
        {name: "å®å‰‘äº”", path: "2/23/Swords05.jpg", yn: "No"}, {name: "å®å‰‘å…­", path: "2/29/Swords06.jpg", yn: "Yes"},
        {name: "å®å‰‘ä¸ƒ", path: "3/34/Swords07.jpg", yn: "No"}, {name: "å®å‰‘å…«", path: "a/a7/Swords08.jpg", yn: "No"},
        {name: "å®å‰‘ä¹", path: "2/2f/Swords09.jpg", yn: "No"}, {name: "å®å‰‘å", path: "d/d4/Swords10.jpg", yn: "No"},
        {name: "å®å‰‘ä¾ä»", path: "4/4c/SwordsPage.jpg", yn: "Maybe"}, {name: "å®å‰‘éª‘å£«", path: "b/b0/SwordsKnight.jpg", yn: "No"},
        {name: "å®å‰‘ç‹å", path: "d/d4/SwordsQueen.jpg", yn: "No"}, {name: "å®å‰‘å›½ç‹", path: "3/33/SwordsKing.jpg", yn: "No"},
        {name: "æ˜Ÿå¸ä¸€", path: "f/fd/Pents01.jpg", yn: "Yes"}, {name: "æ˜Ÿå¸äºŒ", path: "9/9f/Pents02.jpg", yn: "Maybe"},
        {name: "æ˜Ÿå¸ä¸‰", path: "4/42/Pents03.jpg", yn: "Yes"}, {name: "æ˜Ÿå¸å››", path: "3/35/Pents04.jpg", yn: "Maybe"},
        {name: "æ˜Ÿå¸äº”", path: "9/96/Pents05.jpg", yn: "No"}, {name: "æ˜Ÿå¸å…­", path: "a/a6/Pents06.jpg", yn: "Yes"},
        {name: "æ˜Ÿå¸ä¸ƒ", path: "6/6a/Pents07.jpg", yn: "Maybe"}, {name: "æ˜Ÿå¸å…«", path: "4/49/Pents08.jpg", yn: "Yes"},
        {name: "æ˜Ÿå¸ä¹", path: "f/f0/Pents09.jpg", yn: "Yes"}, {name: "æ˜Ÿå¸å", path: "4/42/Pents10.jpg", yn: "Yes"},
        {name: "æ˜Ÿå¸ä¾ä»", path: "e/e0/PentsPage.jpg", yn: "Yes"}, {name: "æ˜Ÿå¸éª‘å£«", path: "c/c6/PentsKnight.jpg", yn: "Yes"},
        {name: "æ˜Ÿå¸ç‹å", path: "8/88/PentsQueen.jpg", yn: "Yes"}, {name: "æ˜Ÿå¸å›½ç‹", path: "1/14/PentsKing.jpg", yn: "Yes"}
    ];

    let currentTab = 'triangle'; 
    let drawMode = 'random';
    let manualChoices = [];
    let shuffledIndices = [];

    // åˆå§‹åŒ–
    function init() {
        createManualDeck();
        switchTab('triangle');
    }

    function switchTab(tab) {
        currentTab = tab;
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event?.target?.classList?.add('active'); // ä»…åœ¨ç‚¹å‡»æ—¶æœ‰æ•ˆ
        
        document.getElementById('results').innerHTML = '';
        document.getElementById('status-bar').innerText = "å·²åˆ‡æ¢æ¨¡å¼ï¼Œè¯·å¼€å§‹";
        
        if(drawMode === 'manual') resetManual();
    }

    function toggleDrawMode(mode) {
        drawMode = mode;
        document.getElementById('btn-rnd').classList.toggle('active', mode === 'random');
        document.getElementById('btn-man').classList.toggle('active', mode === 'manual');
        
        document.getElementById('draw-trigger').style.display = (mode === 'random') ? 'inline-block' : 'none';
        document.getElementById('manual-deck').style.display = (mode === 'manual') ? 'flex' : 'none';
        
        if(mode === 'manual') resetManual();
    }

    function createManualDeck() {
        const deck = document.getElementById('manual-deck');
        for(let i=0; i<78; i++) {
            const d = document.createElement('div');
            d.className = 'card-back';
            d.onclick = () => pickCard(i, d);
            deck.appendChild(d);
        }
    }

    function resetManual() {
        manualChoices = [];
        shuffledIndices = Array.from({length: 78}, (_, i) => i).sort(() => Math.random() - 0.5);
        document.querySelectorAll('.card-back').forEach(c => c.classList.remove('selected'));
        document.getElementById('status-bar').innerText = "è¯·ä»ä¸‹æ–¹é€‰æ‹©å¡ç‰Œ...";
    }

    function pickCard(uiIdx, element) {
        if (element.classList.contains('selected')) return;
        
        const limit = (currentTab === 'yesno') ? 1 : 3;
        if (manualChoices.length >= limit) return;

        element.classList.add('selected');
        manualChoices.push(shuffledIndices[uiIdx]);

        document.getElementById('status-bar').innerText = `å·²é€‰ ${manualChoices.length} / ${limit}`;
        if(manualChoices.length === limit) renderResults(manualChoices);
    }

    function executeDraw() {
        const limit = (currentTab === 'yesno') ? 1 : 3;
        const result = Array.from({length: 78}, (_, i) => i).sort(() => Math.random() - 0.5).slice(0, limit);
        renderResults(result);
    }

    function renderResults(indices) {
        const container = document.getElementById('results');
        container.innerHTML = '';
        
        indices.forEach((idx, i) => {
            const data = tarotData[idx];
            const isRev = Math.random() > 0.5;
            
            const cardDiv = document.createElement('div');
            cardDiv.className = 'card-item';
            cardDiv.style.animationDelay = `${i * 0.2}s`;

            // æ ‡ç­¾å¤„ç†
            let labelText = '';
            if(currentTab === 'triangle') {
                labelText = ['è¿‡å»', 'ç°åœ¨', 'æœªæ¥'][i];
            } else if(currentTab === 'free') {
                labelText = `å¡ç‰Œ ${i+1}`;
            }

            // Yes No é€»è¾‘
            let ynHtml = '';
            if(currentTab === 'yesno') {
                let finalAns = data.yn;
                if(isRev) { // é€†ä½åè½¬é€»è¾‘
                    if(finalAns === "Yes") finalAns = "No";
                    else if(finalAns === "No") finalAns = "Yes";
                }
                const color = finalAns === "Yes" ? "#4caf50" : (finalAns === "No" ? "#f44336" : "#ff9800");
                ynHtml = `<div class="ans-tag" style="color:${color}">${finalAns}!</div>`;
            }

            cardDiv.innerHTML = `
                ${labelText ? `<div class="label">${labelText}</div>` : ''}
                <div class="img-wrap ${isRev ? 'reversed' : ''}">
                    <img src="${baseUrl + data.path}" alt="${data.name}">
                </div>
                <div class="card-name">${data.name} ${isRev ? '(é€†)' : ''}</div>
                ${ynHtml}
            `;
            container.appendChild(cardDiv);
        });
        document.getElementById('status-bar').innerText = "è§£ç‰Œå®Œæˆ";
    }

    window.onload = init;
</script>
</body>
</html>
