<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘½è¿å¡”ç½— - åœ£ä¸‰è§’å åœ</title>
    <style>
        /* === æ ·å¼è®¾è®¡ === */
        :root {
            --primary-color: #e0c097;
            --bg-gradient: radial-gradient(circle at center, #2c003e 0%, #0f0016 100%);
            --card-back-pattern: repeating-linear-gradient(45deg, #4a2c5a, #4a2c5a 10px, #3a1c4a 10px, #3a1c4a 20px);
        }

        body {
            background: var(--bg-gradient);
            color: var(--primary-color);
            font-family: 'Georgia', serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 { text-shadow: 2px 2px 4px #000; margin-bottom: 5px; }
        .subtitle { color: #b893cc; font-size: 0.9em; margin-bottom: 20px; }

        /* æ¨¡å¼åˆ‡æ¢æŒ‰é’® */
        .mode-switch {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .mode-btn {
            background: transparent;
            border: 2px solid #5a3875;
            color: #b893cc;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: #5a3875;
            color: #fff;
            box-shadow: 0 0 10px #5a3875;
        }

        /* æŠ½å–æŒ‰é’® (éšæœºæ¨¡å¼ç”¨) */
        .action-btn {
            background: linear-gradient(45deg, #5a3875, #8a58a8);
            border: none;
            color: #fff;
            padding: 12px 40px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            margin-bottom: 20px;
            transition: transform 0.2s;
        }
        .action-btn:hover { transform: scale(1.05); }

        /* === ç»“æœå±•ç¤ºåŒº (ä¸‰å¼ ç‰Œ) === */
        .result-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            width: 100%;
            max-width: 900px;
            min-height: 380px; /* é¢„ç•™é«˜åº¦ */
        }

        .card-slot {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 150px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        
        .card-slot.show { opacity: 1; transform: translateY(0); }

        .slot-label {
            font-size: 14px;
            color: #8a58a8;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: bold;
        }

        .card-img-box {
            width: 150px;
            height: 260px;
            border-radius: 10px;
            border: 2px solid #e0c097;
            overflow: hidden;
            background: #000;
            position: relative;
            box-shadow: 0 0 15px rgba(224, 192, 151, 0.2);
        }

        .card-img-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶çš„æ›¿ä»£æ–‡å­— */
        .img-fallback {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 10px;
            box-sizing: border-box;
            background: #220033;
            color: #fff;
            font-size: 18px;
            display: none; /* é»˜è®¤éšè— */
        }

        .reversed img { transform: rotate(180deg); }
        .reversed .img-fallback { transform: rotate(180deg); }

        .card-name { margin-top: 10px; font-weight: bold; font-size: 16px; text-align: center;}
        .card-direction { font-size: 12px; color: #aaa; }

        /* === è‡ªé€‰æ¨¡å¼ï¼šç‰ŒèƒŒç½‘æ ¼ === */
        #manual-deck-area {
            display: none; /* é»˜è®¤éšè— */
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            max-width: 800px;
            margin-top: 20px;
        }

        .card-back {
            width: 40px;
            height: 70px;
            background: var(--card-back-pattern);
            border: 1px solid #5a3875;
            border-radius: 4px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .card-back:hover { transform: translateY(-5px); border-color: #e0c097; }
        .card-back.selected { visibility: hidden; pointer-events: none; } /* é€‰ä¸­åæ¶ˆå¤± */

        /* æç¤ºä¿¡æ¯ */
        #status-msg { height: 20px; color: #e0c097; margin-bottom: 10px; }

    </style>
</head>
<body>

    <h1>âœ¨ å‘½è¿åœ£ä¸‰è§’ âœ¨</h1>
    <div class="subtitle">ä¸“æ³¨ä½ çš„é—®é¢˜ï¼Œæ­ç¤ºè¿‡å»ã€ç°åœ¨ä¸æœªæ¥</div>

    <div class="mode-switch">
        <button class="mode-btn active" onclick="setMode('random')">ğŸ”® éšæœºæŠ½å–</button>
        <button class="mode-btn" onclick="setMode('manual')">âœ‹ äº²è‡ªæŠ½ç‰Œ</button>
    </div>

    <div id="status-msg">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹...</div>

    <button id="random-btn" class="action-btn" onclick="drawThreeRandom()">å¼€å§‹æ´—ç‰Œå¹¶æŠ½å–</button>

    <div id="manual-deck-area"></div>

    <div class="result-area" id="result-area">
        <div class="card-slot" id="slot-0">
            <div class="slot-label">Past / è¿‡å»</div>
            <div class="card-img-box">
                <div class="img-fallback"></div>
                <img src="" alt="Card" onerror="this.style.display='none'; this.previousElementSibling.style.display='flex'; this.previousElementSibling.innerText = this.getAttribute('data-name')">
            </div>
            <div class="card-name"></div>
            <div class="card-direction"></div>
        </div>

        <div class="card-slot" id="slot-1">
            <div class="slot-label">Present / ç°åœ¨</div>
            <div class="card-img-box">
                <div class="img-fallback"></div>
                <img src="" alt="Card" onerror="this.style.display='none'; this.previousElementSibling.style.display='flex'; this.previousElementSibling.innerText = this.getAttribute('data-name')">
            </div>
            <div class="card-name"></div>
            <div class="card-direction"></div>
        </div>

        <div class="card-slot" id="slot-2">
            <div class="slot-label">Future / æœªæ¥</div>
            <div class="card-img-box">
                <div class="img-fallback"></div>
                <img src="" alt="Card" onerror="this.style.display='none'; this.previousElementSibling.style.display='flex'; this.previousElementSibling.innerText = this.getAttribute('data-name')">
            </div>
            <div class="card-name"></div>
            <div class="card-direction"></div>
        </div>
    </div>

<script>
    // === æ•°æ®å‡†å¤‡ï¼šä½¿ç”¨ Wikimedia Commons çš„ç¨³å®šé“¾æ¥ ===
    // åŸºç¡€è·¯å¾„
    const baseUrl = "https://upload.wikimedia.org/wikipedia/commons/";
    
    // 78å¼ ç‰Œçš„æ•°æ®æ˜ å°„ (ç®€åŒ–ç‰ˆï¼Œè‡ªåŠ¨æ˜ å°„æ–‡ä»¶å)
    const tarotData = [
        {name: "æ„šè€…", en: "The Fool", path: "9/90/RWS_Tarot_00_Fool.jpg"},
        {name: "é­”æœ¯å¸ˆ", en: "The Magician", path: "d/de/RWS_Tarot_01_Magician.jpg"},
        {name: "å¥³æ•™çš‡", en: "High Priestess", path: "8/88/RWS_Tarot_02_High_Priestess.jpg"},
        {name: "çš‡å", en: "The Empress", path: "d/d2/RWS_Tarot_03_Empress.jpg"},
        {name: "çš‡å¸", en: "The Emperor", path: "c/c3/RWS_Tarot_04_Emperor.jpg"},
        {name: "æ•™çš‡", en: "The Hierophant", path: "8/8d/RWS_Tarot_05_Hierophant.jpg"},
        {name: "æ‹äºº", en: "The Lovers", path: "3/3a/TheLovers.jpg"}, // ç‰¹æ®Šå‘½å
        {name: "æˆ˜è½¦", en: "The Chariot", path: "9/9b/RWS_Tarot_07_Chariot.jpg"},
        {name: "åŠ›é‡", en: "Strength", path: "f/f5/RWS_Tarot_08_Strength.jpg"},
        {name: "éšå£«", en: "The Hermit", path: "4/4d/RWS_Tarot_09_Hermit.jpg"},
        {name: "å‘½è¿ä¹‹è½®", en: "Wheel of Fortune", path: "3/3c/RWS_Tarot_10_Wheel_of_Fortune.jpg"},
        {name: "æ­£ä¹‰", en: "Justice", path: "e/e0/RWS_Tarot_11_Justice.jpg"},
        {name: "å€’åŠäºº", en: "The Hanged Man", path: "2/2b/RWS_Tarot_12_Hanged_Man.jpg"},
        {name: "æ­»ç¥", en: "Death", path: "d/d7/RWS_Tarot_13_Death.jpg"},
        {name: "èŠ‚åˆ¶", en: "Temperance", path: "f/f8/RWS_Tarot_14_Temperance.jpg"},
        {name: "æ¶é­”", en: "The Devil", path: "5/55/RWS_Tarot_15_Devil.jpg"},
        {name: "é«˜å¡”", en: "The Tower", path: "5/53/RWS_Tarot_16_Tower.jpg"},
        {name: "æ˜Ÿæ˜Ÿ", en: "The Star", path: "d/db/RWS_Tarot_17_Star.jpg"},
        {name: "æœˆäº®", en: "The Moon", path: "7/7f/RWS_Tarot_18_Moon.jpg"},
        {name: "å¤ªé˜³", en: "The Sun", path: "1/17/RWS_Tarot_19_Sun.jpg"},
        {name: "å®¡åˆ¤", en: "Judgement", path: "d/dd/RWS_Tarot_20_Judgement.jpg"},
        {name: "ä¸–ç•Œ", en: "The World", path: "f/ff/RWS_Tarot_21_World.jpg"},
        
        // å°é˜¿å¡çº³ - æƒæ– (Wands)
        {name: "æƒæ–ä¸€", path: "1/11/Wands01.jpg"}, {name: "æƒæ–äºŒ", path: "0/0f/Wands02.jpg"},
        {name: "æƒæ–ä¸‰", path: "f/ff/Wands03.jpg"}, {name: "æƒæ–å››", path: "a/a4/Wands04.jpg"},
        {name: "æƒæ–äº”", path: "9/9d/Wands05.jpg"}, {name: "æƒæ–å…­", path: "3/3b/Wands06.jpg"},
        {name: "æƒæ–ä¸ƒ", path: "e/e4/Wands07.jpg"}, {name: "æƒæ–å…«", path: "6/6b/Wands08.jpg"},
        {name: "æƒæ–ä¹", path: "4/4d/Tarot_Nine_of_Wands.jpg"}, {name: "æƒæ–å", path: "0/0b/Wands10.jpg"},
        {name: "æƒæ–ä¾ä»", path: "6/6a/WandsPage.jpg"}, {name: "æƒæ–éª‘å£«", path: "1/16/WandsKnight.jpg"},
        {name: "æƒæ–ç‹å", path: "0/0d/WandsQueen.jpg"}, {name: "æƒæ–å›½ç‹", path: "c/ce/WandsKing.jpg"},

        // å°é˜¿å¡çº³ - åœ£æ¯ (Cups)
        {name: "åœ£æ¯ä¸€", path: "3/36/Cups01.jpg"}, {name: "åœ£æ¯äºŒ", path: "f/f8/Cups02.jpg"},
        {name: "åœ£æ¯ä¸‰", path: "7/7a/Cups03.jpg"}, {name: "åœ£æ¯å››", path: "3/35/Cups04.jpg"},
        {name: "åœ£æ¯äº”", path: "d/d7/Cups05.jpg"}, {name: "åœ£æ¯å…­", path: "1/17/Cups06.jpg"},
        {name: "åœ£æ¯ä¸ƒ", path: "a/ae/Cups07.jpg"}, {name: "åœ£æ¯å…«", path: "6/60/Cups08.jpg"},
        {name: "åœ£æ¯ä¹", path: "2/24/Cups09.jpg"}, {name: "åœ£æ¯å", path: "8/84/Cups10.jpg"},
        {name: "åœ£æ¯ä¾ä»", path: "a/a6/CupsPage.jpg"}, {name: "åœ£æ¯éª‘å£«", path: "f/fa/CupsKnight.jpg"},
        {name: "åœ£æ¯ç‹å", path: "6/61/CupsQueen.jpg"}, {name: "åœ£æ¯å›½ç‹", path: "f/f0/CupsKing.jpg"},

        // å°é˜¿å¡çº³ - å®å‰‘ (Swords)
        {name: "å®å‰‘ä¸€", path: "1/1a/Swords01.jpg"}, {name: "å®å‰‘äºŒ", path: "9/92/Swords02.jpg"},
        {name: "å®å‰‘ä¸‰", path: "2/2c/Swords03.jpg"}, {name: "å®å‰‘å››", path: "b/bf/Swords04.jpg"},
        {name: "å®å‰‘äº”", path: "2/23/Swords05.jpg"}, {name: "å®å‰‘å…­", path: "2/29/Swords06.jpg"},
        {name: "å®å‰‘ä¸ƒ", path: "3/34/Swords07.jpg"}, {name: "å®å‰‘å…«", path: "a/a7/Swords08.jpg"},
        {name: "å®å‰‘ä¹", path: "2/2f/Swords09.jpg"}, {name: "å®å‰‘å", path: "d/d4/Swords10.jpg"},
        {name: "å®å‰‘ä¾ä»", path: "4/4c/SwordsPage.jpg"}, {name: "å®å‰‘éª‘å£«", path: "b/b0/SwordsKnight.jpg"},
        {name: "å®å‰‘ç‹å", path: "d/d4/SwordsQueen.jpg"}, {name: "å®å‰‘å›½ç‹", path: "3/33/SwordsKing.jpg"},

        // å°é˜¿å¡çº³ - æ˜Ÿå¸ (Pentacles)
        {name: "æ˜Ÿå¸ä¸€", path: "f/fd/Pents01.jpg"}, {name: "æ˜Ÿå¸äºŒ", path: "9/9f/Pents02.jpg"},
        {name: "æ˜Ÿå¸ä¸‰", path: "4/42/Pents03.jpg"}, {name: "æ˜Ÿå¸å››", path: "3/35/Pents04.jpg"},
        {name: "æ˜Ÿå¸äº”", path: "9/96/Pents05.jpg"}, {name: "æ˜Ÿå¸å…­", path: "a/a6/Pents06.jpg"},
        {name: "æ˜Ÿå¸ä¸ƒ", path: "6/6a/Pents07.jpg"}, {name: "æ˜Ÿå¸å…«", path: "4/49/Pents08.jpg"},
        {name: "æ˜Ÿå¸ä¹", path: "f/f0/Pents09.jpg"}, {name: "æ˜Ÿå¸å", path: "4/42/Pents10.jpg"},
        {name: "æ˜Ÿå¸ä¾ä»", path: "e/e0/PentsPage.jpg"}, {name: "æ˜Ÿå¸éª‘å£«", path: "c/c6/PentsKnight.jpg"},
        {name: "æ˜Ÿå¸ç‹å", path: "8/88/PentsQueen.jpg"}, {name: "æ˜Ÿå¸å›½ç‹", path: "1/14/PentsKing.jpg"}
    ];

    let currentMode = 'random'; // 'random' æˆ– 'manual'
    let manualSelectedCount = 0;
    let manualResults = [];

    // === åˆå§‹åŒ– ===
    window.onload = function() {
        createManualDeck();
    };

    // åˆ‡æ¢æ¨¡å¼
    function setMode(mode) {
        currentMode = mode;
        
        // æ›´æ–°æŒ‰é’®æ ·å¼
        document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');

        // ç•Œé¢åˆ‡æ¢
        const randomBtn = document.getElementById('random-btn');
        const manualArea = document.getElementById('manual-deck-area');
        const statusMsg = document.getElementById('status-msg');
        
        // é‡ç½®ç•Œé¢
        resetDisplay();

        if (mode === 'random') {
            randomBtn.style.display = 'block';
            manualArea.style.display = 'none';
            statusMsg.innerText = "ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹éšæœºæŠ½å–";
        } else {
            randomBtn.style.display = 'none';
            manualArea.style.display = 'flex';
            statusMsg.innerText = "è¯·å‡­ç›´è§‰ç‚¹å‡» 3 å¼ ç‰Œ...";
            resetManualDeck();
        }
    }

    // é‡ç½®å±•ç¤ºåŒº
    function resetDisplay() {
        for(let i=0; i<3; i++) {
            const slot = document.getElementById(`slot-${i}`);
            slot.classList.remove('show');
        }
    }

    // === é€»è¾‘æ ¸å¿ƒï¼šæ´—ç‰Œ ===
    function shuffleDeck() {
        // åˆ›å»ºç´¢å¼•æ•°ç»„ 0-77
        let deck = Array.from({length: 78}, (_, i) => i);
        // Fisher-Yates æ´—ç‰Œç®—æ³•
        for (let i = deck.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [deck[i], deck[j]] = [deck[j], deck[i]];
        }
        return deck;
    }

    // === æ¨¡å¼1ï¼šéšæœºæŠ½å–ä¸‰å¼  ===
    function drawThreeRandom() {
        const statusMsg = document.getElementById('status-msg');
        statusMsg.innerText = "æ­£åœ¨æ´—ç‰Œå¹¶è¿æ¥å®‡å®™...";
        
        resetDisplay();

        setTimeout(() => {
            const shuffledIndices = shuffleDeck();
            const selectedIndices = [shuffledIndices[0], shuffledIndices[1], shuffledIndices[2]];
            
            displayResults(selectedIndices);
            statusMsg.innerText = "æŠ½ç‰Œå®Œæˆï¼Œè§£è¯»å¦‚ä¸‹";
        }, 600);
    }

    // === æ¨¡å¼2ï¼šè‡ªé€‰æ¨¡å¼ ===
    
    // åˆ›å»º78å¼ ç‰ŒèƒŒ
    function createManualDeck() {
        const area = document.getElementById('manual-deck-area');
        area.innerHTML = '';
        for (let i = 0; i < 78; i++) {
            const card = document.createElement('div');
            card.className = 'card-back';
            card.onclick = () => selectManualCard(card, i); // è¿™é‡Œçš„iåªæ˜¯ä¸ºäº†ç‹¬ç«‹æ€§ï¼Œå®é™…ç»“æœè¿˜æ˜¯éšæœºç”Ÿæˆ
            area.appendChild(card);
        }
    }

    function resetManualDeck() {
        manualSelectedCount = 0;
        manualResults = [];
        const cards = document.querySelectorAll('.card-back');
        cards.forEach(card => card.classList.remove('selected'));
        // æ¯æ¬¡è¿›å…¥è‡ªé€‰æ¨¡å¼ï¼Œæˆ‘ä»¬åœ¨åå°æ´—ä¸€æ¬¡ç‰Œï¼Œç”¨æˆ·ç‚¹å‡»çš„ä½ç½®å¯¹åº”æ´—ç‰Œåçš„é¡ºåº
        window.currentShuffledDeck = shuffleDeck();
    }

    function selectManualCard(element, index) {
        if (manualSelectedCount >= 3) return;

        // è§†è§‰ä¸Šç§»é™¤è¿™å¼ ç‰Œ
        element.classList.add('selected');
        
        // ä»é¢„å…ˆæ´—å¥½çš„ç‰Œå †é‡Œæ‹¿ä¸€å¼ 
        const cardIndex = window.currentShuffledDeck[manualSelectedCount];
        manualResults.push(cardIndex);
        manualSelectedCount++;

        document.getElementById('status-msg').innerText = `å·²é€‰ ${manualSelectedCount} / 3 å¼ `;

        if (manualSelectedCount === 3) {
            document.getElementById('status-msg').innerText = "é€‰ç‰Œå®Œæˆï¼Œæ­£åœ¨ç¿»å¼€...";
            setTimeout(() => {
                displayResults(manualResults);
            }, 500);
        }
    }

    // === å…¬å…±ï¼šå±•ç¤ºç»“æœ ===
    function displayResults(cardIndices) {
        cardIndices.forEach((cardIndex, i) => {
            const cardData = tarotData[cardIndex];
            const isReversed = Math.random() > 0.5; // 50% æ¦‚ç‡é€†ä½

            const slot = document.getElementById(`slot-${i}`);
            const img = slot.querySelector('img');
            const fallback = slot.querySelector('.img-fallback');
            const nameDiv = slot.querySelector('.card-name');
            const dirDiv = slot.querySelector('.card-direction');

            // è®¾ç½®å›¾ç‰‡
            // é‡ç½®é”™è¯¯å¤„ç†ï¼Œé˜²æ­¢ä¸Šæ¬¡çš„é”™è¯¯çŠ¶æ€æ®‹ç•™
            img.style.display = 'block';
            fallback.style.display = 'none';
            img.setAttribute('data-name', cardData.name); // å­˜åå­—ä»¥ä¾¿æŠ¥é”™æ—¶ç”¨
            img.src = baseUrl + cardData.path;

            // è®¾ç½®æ–‡å­—
            nameDiv.innerText = cardData.name;
            dirDiv.innerText = isReversed ? "â–¼ é€†ä½ (Reversed)" : "â–² æ­£ä½ (Upright)";

            // å¤„ç†æ—‹è½¬æ ·å¼
            const imgBox = slot.querySelector('.card-img-box');
            if (isReversed) {
                imgBox.classList.add('reversed');
            } else {
                imgBox.classList.remove('reversed');
            }

            // åŠ¨ç”»æ˜¾ç¤º
            setTimeout(() => {
                slot.classList.add('show');
            }, i * 300); // ä¾æ¬¡æ˜¾ç¤º
        });
    }

</script>
</body>
</html>
